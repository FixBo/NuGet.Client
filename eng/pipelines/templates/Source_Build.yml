# This Yaml Document has been converted by ESAI Yaml Pipeline Conversion Tool.
# Please make sure to check all the converted content, it is your team's responsibility to make sure that the pipeline is still valid and functions as expected.
# The Task 'PublishPipelineArtifact@1' has been converted to an output named 'Upload source-build log' in the templateContext section.
steps:
- task: PowerShell@2
  displayName: "Build source-build"
  inputs:
    targetType: "inline"
    script: |
      ./eng/source-build/build.sh
  condition: "always()"
- task: ComponentGovernanceComponentDetection@0
  displayName: 'Component Detection'
- task: PowerShell@2
  displayName: "Initialize Git Commit Status on GitHub"
  inputs:
    targetType: "inline"
    script: |
      . $(Build.Repository.LocalPath)/scripts/utils/PostGitCommitStatus.ps1
      SetCommitStatusForTestResult -PersonalAccessToken $(NuGetLurkerPersonalAccessToken) -VstsPersonalAccessToken $(System.AccessToken) -CommitSha $(Build.SourceVersion) -TestName "$(System.JobDisplayName)"
    failOnStderr: "true"
  condition: "not(eq(variables['ManualGitHubChecks'], 'false'))"